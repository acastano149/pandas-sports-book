# Verbos B√°sicos I: Selecci√≥n, Filtrado y Ordenaci√≥n

Este cap√≠tulo traduce `select()`, `filter()`, `arrange()` de dplyr.

```{pyodide}
import pandas as pd
import numpy as np

# ============================================
# DATOS ENRIQUECIDOS PARA SPORT SCIENTISTS
# ============================================
atletas = pd.DataFrame({
    'JugadorID': [f'ATL_{i:03d}' for i in range(1, 16)],
    'Nombre': ['Garc√≠a', 'L√≥pez', 'Mart√≠nez', 'S√°nchez', 'Fern√°ndez', 
               'Gonz√°lez', 'Rodr√≠guez', 'P√©rez', 'G√≥mez', 'Ruiz',
               'D√≠az', 'Moreno', '√Ålvarez', 'Jim√©nez', 'Romero'],
    'Posicion': ['Delantero', 'Mediocentro', 'Defensa', 'Portero', 'Delantero',
                'Mediocentro', 'Defensa', 'Delantero', 'Mediocentro', 'Defensa',
                'Portero', 'Delantero', 'Mediocentro', 'Defensa', 'Extremo'],
    'Edad': [25, 28, 23, 31, 22, 27, 29, 24, 26, 30, 33, 21, 25, 28, 23],
    'Altura_cm': [178, 175, 182, 188, 176, 180, 185, 173, 177, 184, 190, 172, 179, 183, 175],
    'Peso_kg': [75, 72, 80, 85, 70, 76, 82, 68, 74, 81, 87, 67, 73, 79, 71],
    'VO2max': [58.5, 62.1, 55.0, 48.2, 60.5, 59.0, 54.5, 61.0, 57.5, 53.0, 46.0, 63.0, 58.0, 55.5, 59.5],
    'VelocidadMax_kmh': [32.5, 31.0, 30.2, 28.5, 33.8, 31.5, 29.8, 34.2, 30.5, 29.0, 27.5, 35.0, 31.2, 29.5, 33.0],
    'YoYo_IR1_m': [2120, 2400, 1840, 1280, 2280, 2200, 1720, 2360, 2040, 1680, 1120, 2520, 2080, 1800, 2240]
})

print("‚úÖ Datos cargados:", atletas.shape)
```

***

## 1. Selecci√≥n de Columnas

### Ejemplo 1.1: Selecci√≥n por lista

**En R:** `atletas %>% select(Nombre, Posicion, VO2max)`

**En Pandas:**
```{pyodide}
atletas[['Nombre', 'Posicion', 'VO2max']].head()
```

**¬øPor qu√© doble corchete?** `df['col']` = Series (una columna). `df[['col1', 'col2']]` = DataFrame (varias columnas).

---

### üß† Pr√°ctica 1.1

Selecciona las columnas 'JugadorID', 'VelocidadMax_kmh' y 'YoYo_IR1_m'. Muestra las primeras 5 filas.

```{pyodide}
# Pista: df[['col1', 'col2', 'col3']].head()

# Escribe tu c√≥digo aqu√≠:


```

::: {.callout-tip collapse="true"}
## Ver soluci√≥n
```python
atletas[['JugadorID', 'VelocidadMax_kmh', 'YoYo_IR1_m']].head()
```
:::

***

## 2. Filtrado de Filas

### Ejemplo 2.1: Filtro simple

**En R:** `atletas %>% filter(Edad > 25)`

**En Pandas:**
```{pyodide}
atletas.query("Edad > 25").head()
```

### Ejemplo 2.2: M√∫ltiples condiciones

**En R:** `atletas %>% filter(Edad > 25, Posicion == "Delantero")`

**En Pandas:**
```{pyodide}
atletas.query("Edad > 25 and Posicion == 'Delantero'")
```

### Ejemplo 2.3: Valores en lista

**En R:** `atletas %>% filter(Posicion %in% c("Portero", "Defensa"))`

**En Pandas:**
```{pyodide}
atletas.query("Posicion in ['Portero', 'Defensa']").head()
```

---

### üß† Pr√°ctica 2.1

Filtra atletas con VO2max > 55 Y Edad < 28.

```{pyodide}
# Pista: .query("cond1 and cond2")

# Escribe tu c√≥digo aqu√≠:


```

::: {.callout-tip collapse="true"}
## Ver soluci√≥n
```python
atletas.query("VO2max > 55 and Edad < 28")
```
:::

***

## 3. Ordenaci√≥n

### Ejemplo 3.1: Orden descendente

**En R:** `atletas %>% arrange(desc(VO2max))`

**En Pandas:**
```{pyodide}
atletas.sort_values('VO2max', ascending=False).head()
```

### Ejemplo 3.2: Top N

**En R:** `atletas %>% slice_max(VO2max, n = 5)`

**En Pandas:**
```{pyodide}
atletas.nlargest(5, 'VelocidadMax_kmh')[['Nombre', 'Posicion', 'VelocidadMax_kmh']]
```

---

### üß† Pr√°ctica 3.1

Muestra los 3 atletas con mejor resultado en el YoYo IR1 (mayor distancia).

```{pyodide}
# Pista: .nlargest(n, 'columna')[['cols']]

# Escribe tu c√≥digo aqu√≠:


```

::: {.callout-tip collapse="true"}
## Ver soluci√≥n
```python
atletas.nlargest(3, 'YoYo_IR1_m')[['Nombre', 'Posicion', 'YoYo_IR1_m']]
```
:::

***

## üèÜ Mini-Proyecto: An√°lisis del Plantel por Perfiles F√≠sicos

Responde estas preguntas sobre el dataset `atletas`:

### Pregunta 1: Velocistas del Equipo
¬øQu√© jugadores superan los 33 km/h de velocidad m√°xima? Muestra nombre, posici√≥n y velocidad.

```{pyodide}
# Escribe tu c√≥digo aqu√≠:


```

::: {.callout-tip collapse="true"}
## Ver soluci√≥n
```python
atletas.query("VelocidadMax_kmh > 33")[['Nombre', 'Posicion', 'VelocidadMax_kmh']]
```
:::

### Pregunta 2: Resistencia Aer√≥bica por Posici√≥n
¬øQui√©nes son los centrocampistas con VO2max superior a 57? Son los que m√°s corren.

```{pyodide}
# Escribe tu c√≥digo aqu√≠:


```

::: {.callout-tip collapse="true"}
## Ver soluci√≥n
```python
atletas.query("Posicion == 'Mediocentro' and VO2max > 57")[['Nombre', 'VO2max', 'YoYo_IR1_m']]
```
:::

### Pregunta 3: Delanteros J√≥venes y R√°pidos
Filtra delanteros menores de 25 a√±os y ord√©nalos por velocidad m√°xima (descendente).

```{pyodide}
# Escribe tu c√≥digo aqu√≠:


```

::: {.callout-tip collapse="true"}
## Ver soluci√≥n
```python
(
    atletas
    .query("Posicion == 'Delantero' and Edad < 25")
    .sort_values('VelocidadMax_kmh', ascending=False)
    [['Nombre', 'Edad', 'VelocidadMax_kmh']]
)
```
:::

### Pregunta 4: Top 5 en Test YoYo
¬øQui√©nes son los 5 atletas con mejor rendimiento en el YoYo IR1? Incluye la posici√≥n para ver si hay un patr√≥n.

```{pyodide}
# Escribe tu c√≥digo aqu√≠:


```

::: {.callout-tip collapse="true"}
## Ver soluci√≥n
```python
atletas.nlargest(5, 'YoYo_IR1_m')[['Nombre', 'Posicion', 'YoYo_IR1_m', 'VO2max']]
```
:::

---

## Resumen

| Operaci√≥n | R (Tidyverse) | Python (Pandas) |
|-----------|---------------|-----------------|
| Seleccionar | `select(col1, col2)` | `df[['col1', 'col2']]` |
| Filtrar | `filter(cond)` | `.query("cond")` |
| Ordenar desc | `arrange(desc(col))` | `.sort_values('col', ascending=False)` |
| Top N | `slice_max(col, n=5)` | `.nlargest(5, 'col')` |
